(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[190],{8086:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cart",function(){return t(7620)}])},7620:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return p}});var r=t(5893),a=t(7294),n=t(1234),d=e=>{let{children:s,onClose:t}=e;return(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)("div",{className:"bg-white p-5 rounded-lg shadow-lg w-1/2",children:[(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)("button",{onClick:t,className:"text-red-500 font-bold",children:"X"})}),s]})})};let i=["Delhi NCR","Haryana"],l={"Delhi NCR":["Delhi"],Haryana:["Gurugram"]};var c=e=>{let{onSubmit:s}=e,[t,n]=(0,a.useState)({name:"",type:"website",addressLine1:"",addressLine2:"",city:"",pincode:"",landmark:"",state:"",phone:"",gstNumber:""}),[d,c]=(0,a.useState)({}),[o,m]=(0,a.useState)(null),u=e=>{let{name:s,value:t}=e.target;n(e=>({...e,[s]:t})),c(e=>({...e,[s]:null})),"state"===s&&n(e=>({...e,city:""}))},h=()=>{let e={};return["name","addressLine1","city","state","phone","pincode"].forEach(s=>{t[s]||(e[s]="".concat(s[0].toUpperCase()+s.slice(1).replace(/([A-Z])/g," $1")," is required"))}),t.pincode&&(6!==t.pincode.length||isNaN(Number(t.pincode)))&&(e.pincode="Pincode must be exactly 6 digits"),t.phone&&(10!==t.phone.length||isNaN(Number(t.phone)))&&(e.phone="Phone number must be exactly 10 digits"),t.gstNumber&&!/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[A-Z0-9]{1}[Z]{1}[A-Z0-9]{1}$/.test(t.gstNumber)&&(e.gstNumber="Invalid GST number format"),c(e),0===Object.keys(e).length},x=async e=>{e.preventDefault(),h()&&m(await s(t))};return(0,r.jsxs)("div",{className:"mt-4 ",children:[(0,r.jsxs)("form",{onSubmit:x,children:[["name","phone","addressLine1","addressLine2","landmark","pincode","gstNumber"].map(e=>(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("input",{type:"text",name:e,placeholder:e.charAt(0).toUpperCase()+e.slice(1).replace(/([A-Z])/g," $1"),value:t[e],onChange:u,className:"px-3 py-2 border rounded-md w-full text-sm ".concat(d[e]?"border-red-500":"border-gray-300")}),d[e]&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d[e]})]},e)),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("select",{name:"state",value:t.state,onChange:u,className:"px-3 py-2 border rounded-md w-full text-sm ".concat(d.state?"border-red-500":"border-gray-300"),children:[(0,r.jsx)("option",{value:"",children:"Select State"}),i.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}),d.state&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.state})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("select",{name:"city",value:t.city,onChange:u,disabled:!t.state,className:"px-3 py-2 border rounded-md w-full text-sm ".concat(d.city?"border-red-500":"border-gray-300"),children:[(0,r.jsx)("option",{value:"",children:"Select City"}),t.state&&l[t.state].map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}),d.city&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.city})]}),(0,r.jsx)("button",{type:"submit",className:"w-full rounded-md bg-indigo-600 py-2 text-white text-sm hover:bg-indigo-500",children:"Submit"})]}),o&&(0,r.jsxs)("div",{className:"mt-4 mx-auto p-4 max-w-lg overflow-y-auto",children:[(0,r.jsx)("h2",{className:"text-lg",children:"Order Details"}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md mt-4 p-4",children:[(0,r.jsxs)("p",{className:"mb-2 text-sm",children:[(0,r.jsx)("strong",{children:"Product Name:"})," ",o.productName]}),(0,r.jsxs)("p",{className:"mb-2 text-sm",children:[(0,r.jsx)("strong",{children:"Order Price:"})," ",o.orderPrice]}),(0,r.jsx)("h3",{className:"text-md mt-2 mb-2",children:(0,r.jsx)("strong",{children:"Customer Information"})}),(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("strong",{children:"Name:"})," ",o.customerName]}),(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("strong",{children:"Address:"})," ",o.addressLine1,","," ",o.addressLine2,", ",o.landmark,", ",o.city,","," ",o.state,", ",o.pincode]}),(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("strong",{children:"Phone:"})," ",o.phone]}),o.gstNumber&&(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("strong",{children:"GST Number:"})," ",o.gstNumber]})]})]})]})},o=t(9603),m=t(9417),u=e=>{let{orderData:s,formData:t,onConfirm:n}=e,[d,i]=(0,a.useState)(!1),l=s.reduce((e,s)=>e+s.quantity*s.product.price_per_unit,0),c=async()=>{try{await n(),i(!0)}catch(e){console.error("Error confirming order:",e)}};return(0,r.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-lg max-h-96 overflow-y-auto ".concat(d?"bg-green-100":""),children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Order Summary"}),s.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)("img",{src:"data:image/jpeg;base64,".concat(e.product.imageBase64),alt:e.product.title,className:"w-20 h-20 object-cover rounded-md mr-4"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-lg font-medium",children:e.product.title}),(0,r.jsxs)("p",{children:["Quantity: ",e.quantity," | Price per unit: ₹",e.product.price_per_unit," | Total: ₹",e.quantity*e.product.price_per_unit]})]})]},s)),(0,r.jsxs)("div",{className:"border-t border-gray-200 mt-4 pt-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold",children:"Customer Information"}),(0,r.jsxs)("p",{children:["Name: ",t.name]}),(0,r.jsxs)("p",{children:["Address: ",t.addressLine1,", ",t.addressLine2]}),(0,r.jsxs)("p",{children:["City: ",t.city]}),(0,r.jsxs)("p",{children:["State: ",t.state]}),(0,r.jsxs)("p",{children:["Pincode: ",t.pincode]}),(0,r.jsxs)("p",{children:["Phone: ",t.phone]}),(0,r.jsxs)("p",{children:["GST Number: ",t.gstNumber]})]}),(0,r.jsxs)("div",{className:"border-t border-gray-200 mt-4 pt-4",children:[(0,r.jsx)("h3",{className:"text-xl font-bold",children:"Total Order Value"}),(0,r.jsxs)("p",{className:"text-lg font-medium",children:["₹",l]})]}),d&&(0,r.jsxs)("div",{className:"flex items-center mt-4 text-green-600",children:[(0,r.jsx)(o.G,{icon:m.f8k,className:"mr-2"}),(0,r.jsx)("span",{children:"Order successfully confirmed. Our team will call you soon."})]}),!d&&(0,r.jsx)("button",{onClick:c,className:"mt-4 px-4 py-2 bg-green-500 text-white rounded-lg shadow-md w-full",children:"Confirm Order"})]})};let h="https://via.placeholder.com/150",x=()=>(0,r.jsxs)("div",{className:"p-4 bg-white shadow-md rounded-lg animate-pulse",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"w-20 h-20 bg-gray-200 rounded-md"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/3"}),(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded w-20"})]})]});var p=()=>{let{cartItems:e,increaseQuantity:s,decreaseQuantity:t,removeFromCart:i,clearCart:l}=(0,n.jD)(),[o,m]=(0,a.useState)(!1),[p,j]=(0,a.useState)(null),[g,b]=(0,a.useState)(null),[N,y]=(0,a.useState)(!1),[f,w]=(0,a.useState)([]),[v,S]=(0,a.useState)(!0),[C,_]=(0,a.useState)(null);(0,a.useEffect)(()=>{let s=async e=>{try{let s=await fetch("https://signyards.in/getProductById.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({product:{id:e}})});if(!s.ok)throw Error("Failed to fetch product with ID ".concat(e));return(await s.json())[0]}catch(s){return console.error("Error fetching product with ID ".concat(e,":"),s.message),{id:e,title:"Unknown Product",price_per_unit:0,imageBase64:[],description:""}}},t=async()=>{let t=e.map(e=>s(e.id));try{let e=await Promise.all(t);w(e),S(!1)}catch(e){console.error("Error fetching product details:",e),_(e.message),S(!1)}};e.length>0?t():(S(!1),w([]))},[e]);let k=e.reduce((e,s)=>{let t=f.find(e=>e.id===s.id);return e+(t?Number(t.price_per_unit)*s.quantity:0)},0),P=async()=>{y(!0);try{let e=await fetch("https://signyards.in/getOrder.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({formData:g,orderData:p})});if(!e.ok)throw Error("Network response was not ok");let s=await e.json();console.log("Order confirmed successfully:",s),l(),m(!1)}catch(e){console.error("Error confirming order:",e.message)}finally{y(!1)}};return(0,r.jsxs)("div",{className:"container mx-auto mt-10 p-5",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-8",children:"Cart"}),(0,r.jsxs)("div",{className:"flex flex-col space-y-4",children:[v?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x,{}),(0,r.jsx)(x,{}),(0,r.jsx)(x,{})]}):C?(0,r.jsxs)("div",{children:["Error: ",C]}):e.length>0?e.map(e=>{let a=f.find(s=>s.id===e.id),n=a&&a.imageBase64.length>0?"data:image/jpeg;base64,".concat(a.imageBase64[0]):h;if(!a)return(0,r.jsx)("div",{className:"bg-red-100 p-4 shadow-md rounded-lg",children:(0,r.jsxs)("p",{children:["Product details unavailable for ID: ",e.id,". This item may have been removed."]})},e.id);let d=Number(a.price_per_unit)*e.quantity;return(0,r.jsxs)("div",{className:"flex items-center justify-between bg-white p-4 shadow-md rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("img",{src:n,alt:a.title,className:"w-20 h-20 object-cover rounded-md"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-lg font-medium",children:a.title}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("button",{onClick:()=>t(e.id),className:"px-2 py-1 border rounded",children:"-"}),(0,r.jsx)("span",{className:"mx-2",children:e.quantity}),(0,r.jsx)("button",{onClick:()=>s(e.id),className:"px-2 py-1 border rounded",children:"+"}),(0,r.jsx)("button",{onClick:()=>i(e.id),className:"px-2 py-1 border rounded text-red-500",children:"Delete"})]})]})]}),(0,r.jsxs)("div",{className:"text-lg font-medium text-gray-700",children:["₹",d]})]},e.id)}):(0,r.jsx)("div",{className:"text-center text-gray-500",children:"Your cart is empty."}),e.length>0&&(0,r.jsxs)("div",{className:"flex justify-between items-center mt-8",children:[(0,r.jsx)("div",{className:"p-4 bg-gray-100 rounded-lg shadow-md w-auto",children:(0,r.jsxs)("h2",{className:"text-lg font-bold",children:["Total: ₹",k]})}),(0,r.jsx)("button",{onClick:()=>{m(!0)},className:"px-4 py-2 bg-blue-500 text-white rounded-lg shadow-md",children:"Buy"})]})]}),o&&(0,r.jsx)(d,{onClose:()=>m(!1),children:p&&g?(0,r.jsx)(u,{orderData:p,formData:g,onConfirm:P}):(0,r.jsx)(c,{onSubmit:s=>{j(e.map(e=>({product:f.find(s=>s.id===e.id)||{id:e.id,name:"Unknown Product",price:0,imageSrc:h},quantity:e.quantity}))),b(s),m(!0)}})}),N&&(0,r.jsx)("p",{children:"Submitting order..."})]})}}},function(e){e.O(0,[976,603,888,774,179],function(){return e(e.s=8086)}),_N_E=e.O()}]);